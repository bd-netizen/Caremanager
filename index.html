<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•·ç…§å›°å¢ƒè¨ºæ–·é›·é” - äº’å‹•å¼å››è±¡é™åˆ†æ</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @media print {
            .no-print { display: none !important; }
            body { background: white !important; }
        }
        /* å ±å‘Šæ©«ç·šèƒŒæ™¯ */
        .ruled-paper {
            background-image: linear-gradient(transparent 23px, #e5e7eb 24px);
            background-size: 100% 24px;
            line-height: 24px;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <div id="root"></div>

    <script type="text/babel">
        // å¾å…¨åŸŸ window ä¸­å–å¾—å…ƒä»¶
        const { useState, useMemo, useEffect, useRef } = React;

        // æ¨¡æ“¬ Lucide React å…ƒä»¶ (å› ç‚º CDN ç‰ˆä½¿ç”¨æ–¹å¼ç•¥æœ‰ä¸åŒï¼Œé€™è£¡å»ºç«‹ç°¡å–®å°è£)
        const Icon = ({ name, size = 20, className = "" }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (iconRef.current) {
                    const iconNode = lucide.icons[name];
                    if (iconNode) {
                        const svg = lucide.createIcons({
                            icons: { [name]: iconNode },
                            attrs: { width: size, height: size, class: className }
                        });
                    }
                }
            }, [name, size, className]);
            return <i data-lucide={name} ref={iconRef} className={className}></i>;
        };

        // --- æ ¸å¿ƒè³‡æ–™ ---
        const INITIAL_DATA = [
            { id: 'A01', label: 'æ‰¾ä¸å¤–çœ‹', desc: 'æ‰¾ä¸åˆ°å¤–ç±çœ‹è­·', x: 85, y: 95, cat: 'A' },
            { id: 'A02', label: 'å¤–çœ‹é€ƒé›¢', desc: 'å¤–ç±çœ‹è­·é€ƒè·‘æˆ–æœŸæ»¿é›¢å¢ƒ', x: 95, y: 98, cat: 'A' },
            { id: 'A03', label: 'ç”³è«‹å¤–çœ‹', desc: 'ä¸çŸ¥é“å¦‚ä½•ç”³è«‹å¤–ç±çœ‹è­·', x: 40, y: 45, cat: 'A' },
            { id: 'A04', label: 'æœ¬çœ‹å¤ªè²´', desc: 'æœ¬åœ‹çœ‹è­·è²»ç”¨å¤ªé«˜ç„¡æ³•è² æ“”', x: 90, y: 90, cat: 'A' },
            { id: 'A05', label: 'çœ‹è­·ç›¸è™•', desc: 'çœ‹è­·èˆ‡å®¶äºº/é•·è¼©ç›¸è™•ä¸è‰¯', x: 75, y: 48, cat: 'A' },
            { id: 'A06', label: 'çœ‹è­·æŠ€èƒ½', desc: 'çœ‹è­·æŠ€èƒ½ä¸è¶³æˆ–ä¸å°ˆæ¥­', x: 60, y: 88, cat: 'A' },
            { id: 'A07', label: 'è‡¨æ™‚çœ‹è­·', desc: 'æ‰¾ä¸åˆ°å¯ä¿¡ä»»çš„è‡¨æ™‚çœ‹è­·', x: 80, y: 75, cat: 'A' },
            { id: 'A08', label: 'é¢è©¦æŒ‘é¸', desc: 'ä¸çŸ¥é“å¦‚ä½•é¢è©¦æŒ‘é¸çœ‹è­·', x: 45, y: 40, cat: 'A' },
            { id: 'A09', label: 'åˆç´„æ¢æ¬¾', desc: 'çœ‹è­·åˆç´„æ¢æ¬¾ä¸æ¸…æ¥š', x: 35, y: 30, cat: 'A' },
            { id: 'A10', label: 'è¼ªç…§å…±è­˜', desc: 'å®¶äººè¼ªæµç…§é¡§ä½†ç¼ºä¹å…±è­˜', x: 85, y: 45, cat: 'A' },
            { id: 'A11', label: 'æ‰‹è¶³åˆ†æ“”', desc: 'æ‰‹è¶³ä¸é¡˜åˆ†æ“”ç…§é¡§è²¬ä»»', x: 92, y: 40, cat: 'A' },
            { id: 'A12', label: 'å®¶äººæŠ€èƒ½', desc: 'å®¶äººç…§é¡§æŠ€èƒ½ä¸è¶³', x: 30, y: 85, cat: 'A' },
            { id: 'A13', label: 'ç¨è‡ªç…§é¡§', desc: 'ç¨è‡ªç…§é¡§ç„¡äººæ”¯æ´', x: 90, y: 95, cat: 'A' },
            { id: 'A14', label: 'äººåŠ›ä¸­æ–·', desc: 'ç…§é¡§äººåŠ›çªç„¶ä¸­æ–·', x: 92, y: 96, cat: 'A' },
            { id: 'A15', label: 'è¨“ç·´ç®¡ç†', desc: 'ä¸çŸ¥é“å¦‚ä½•è¨“ç·´æˆ–ç®¡ç†çœ‹è­·', x: 65, y: 60, cat: 'A' },
            { id: 'B01', label: 'å¤±æ™ºç…§é¡§', desc: 'ä¸äº†è§£å¤±æ™ºç—‡ç…§é¡§æŠ€å·§', x: 70, y: 92, cat: 'B' },
            { id: 'B02', label: 'å”åŠ©æ´—æ¾¡', desc: 'ä¸çŸ¥é“å¦‚ä½•å”åŠ©é•·è¼©æ´—æ¾¡', x: 35, y: 65, cat: 'B' },
            { id: 'B03', label: 'æŠ—æ‹’æ´—æ¾¡', desc: 'é•·è¼©æŠ—æ‹’æ´—æ¾¡æˆ–æ›´è¡£', x: 75, y: 55, cat: 'B' },
            { id: 'B04', label: 'é¤µé£Ÿååš¥', desc: 'ä¸çŸ¥é“å¦‚ä½•é¤µé£Ÿååš¥å›°é›£è€…', x: 60, y: 95, cat: 'B' },
            { id: 'B05', label: 'ç¿»èº«æ‹èƒŒ', desc: 'ä¸æœƒç¿»èº«æ‹èƒŒç­‰åŸºç¤ç…§è­·', x: 25, y: 70, cat: 'B' },
            { id: 'B06', label: 'é é˜²å£“ç˜¡', desc: 'ä¸çŸ¥é“å¦‚ä½•é é˜²å£“ç˜¡', x: 30, y: 80, cat: 'B' },
            { id: 'B07', label: 'ç®¡è·¯ç…§è­·', desc: 'ä¸äº†è§£é¼»èƒƒç®¡/å°¿ç®¡ç…§è­·', x: 55, y: 94, cat: 'B' },
            { id: 'B08', label: 'å”åŠ©å¾©å¥', desc: 'ä¸çŸ¥é“å¦‚ä½•å”åŠ©å¾©å¥é‹å‹•', x: 45, y: 45, cat: 'B' },
            { id: 'B09', label: 'è—¥ç‰©ç®¡ç†', desc: 'è—¥ç‰©ç®¡ç†æ··äº‚æˆ–å¿˜è¨˜çµ¦è—¥', x: 25, y: 85, cat: 'B' },
            { id: 'B10', label: 'è§€å¯Ÿç—…æƒ…', desc: 'ä¸çŸ¥é“å¦‚ä½•è§€å¯Ÿç—…æƒ…è®ŠåŒ–', x: 60, y: 80, cat: 'B' },
            { id: 'B11', label: 'ç·Šæ€¥è™•ç†', desc: 'ç·Šæ€¥ç‹€æ³ä¸çŸ¥å¦‚ä½•è™•ç†', x: 45, y: 98, cat: 'B' },
            { id: 'B12', label: 'é é˜²è·Œå€’', desc: 'ä¸çŸ¥é“å¦‚ä½•é é˜²è·Œå€’', x: 30, y: 92, cat: 'B' },
            { id: 'B13', label: 'ç‡Ÿé¤Šèª¿ç†', desc: 'ç‡Ÿé¤Šèª¿ç†ä¸çŸ¥å¾ä½•åšèµ·', x: 40, y: 40, cat: 'B' },
            { id: 'B14', label: 'å‚·å£ç…§è­·', desc: 'å‚·å£ç…§è­·ä¸æœƒè™•ç†', x: 55, y: 90, cat: 'B' },
            { id: 'B15', label: 'ä½¿ç”¨è¼”å…·', desc: 'ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨é†«ç™‚è¼”å…·', x: 35, y: 60, cat: 'B' },
            { id: 'C01', label: 'å¤±æ™ºæºé€š', desc: 'ç„¡æ³•å’Œå¤±æ™ºé•·è¼©æœ‰æ•ˆæºé€š', x: 80, y: 85, cat: 'C' },
            { id: 'C02', label: 'æƒ…ç·’æš´èº', desc: 'é•·è¼©æƒ…ç·’æš´èºæ˜“æ€’', x: 75, y: 75, cat: 'C' },
            { id: 'C03', label: 'å¦„æƒ³å¹»è¦º', desc: 'é•·è¼©å‡ºç¾å¦„æƒ³æˆ–å¹»è¦º', x: 85, y: 82, cat: 'C' },
            { id: 'C04', label: 'é‡è¤‡å•è©±', desc: 'é•·è¼©é‡è¤‡å•åŒæ¨£å•é¡Œ', x: 65, y: 35, cat: 'C' },
            { id: 'C05', label: 'ä¸é…åˆç…§', desc: 'é•·è¼©ä¸é…åˆç…§é¡§', x: 80, y: 88, cat: 'C' },
            { id: 'C06', label: 'æ‡·ç–‘è¢«å·', desc: 'é•·è¼©æ‡·ç–‘æ±è¥¿è¢«å·', x: 70, y: 40, cat: 'C' },
            { id: 'C07', label: 'å®‰æ’«æƒ…ç·’', desc: 'ä¸çŸ¥é“å¦‚ä½•å®‰æ’«é•·è¼©æƒ…ç·’', x: 60, y: 75, cat: 'C' },
            { id: 'C08', label: 'æ—¥å¤œé¡›å€’', desc: 'é•·è¼©æ—¥å¤œé¡›å€’åµé¬§', x: 75, y: 85, cat: 'C' },
            { id: 'C09', label: 'æ‹’çµ•å°±é†«', desc: 'é•·è¼©æ‹’çµ•å°±é†«æˆ–æœè—¥', x: 85, y: 90, cat: 'C' },
            { id: 'C10', label: 'å®¶äººä¸åˆ', desc: 'å®¶äººå°ç…§é¡§æ–¹å¼æ„è¦‹ä¸åˆ', x: 90, y: 45, cat: 'C' },
            { id: 'C11', label: 'èªªæœä½¿ç”¨', desc: 'ç„¡æ³•èªªæœé•·è¼©ä½¿ç”¨è³‡æº', x: 80, y: 48, cat: 'C' },
            { id: 'C12', label: 'æ€§æ ¼æ”¹è®Š', desc: 'é•·è¼©æ€§æ ¼æ”¹è®Šé›£ä»¥ç›¸è™•', x: 70, y: 30, cat: 'C' },
            { id: 'D01', label: 'è³‡æºèªçŸ¥', desc: 'ä¸çŸ¥é“æœ‰å“ªäº›é•·ç…§è³‡æºå¯ç”¨', x: 20, y: 45, cat: 'D' },
            { id: 'D02', label: 'ç”³è«‹æœå‹™', desc: 'ä¸çŸ¥é“å¦‚ä½•ç”³è«‹é•·ç…§æœå‹™', x: 25, y: 85, cat: 'D' },
            { id: 'D03', label: 'æµç¨‹è¤‡é›œ', desc: 'é•·ç…§ç”³è«‹æµç¨‹å¤ªè¤‡é›œ', x: 50, y: 60, cat: 'D' },
            { id: 'D04', label: 'è£œåŠ©è³‡æ ¼', desc: 'ä¸çŸ¥é“è‡ªå·±ç¬¦åˆå“ªäº›è£œåŠ©', x: 30, y: 40, cat: 'D' },
            { id: 'D05', label: 'é¡åº¦ä¸è¶³', desc: 'é•·ç…§é¡åº¦ä¸å¤ ç”¨', x: 85, y: 88, cat: 'D' },
            { id: 'D06', label: 'æ—¥ç…§ä¸­å¿ƒ', desc: 'æ‰¾ä¸åˆ°é©åˆçš„æ—¥ç…§ä¸­å¿ƒ', x: 60, y: 75, cat: 'D' },
            { id: 'D07', label: 'èº«éšœè­‰æ˜', desc: 'ä¸çŸ¥é“å¦‚ä½•ç”³è«‹èº«å¿ƒéšœç¤™è­‰æ˜', x: 35, y: 35, cat: 'D' },
            { id: 'D08', label: 'è¼”å…·ç§Ÿè³¼', desc: 'è¼”å…·ç§Ÿå€Ÿæˆ–è³¼è²·ä¸çŸ¥å¾ä½•æ‰¾èµ·', x: 25, y: 30, cat: 'D' },
            { id: 'D09', label: 'ç„¡éšœæ”¹é€ ', desc: 'å±…å®¶ç„¡éšœç¤™æ”¹é€ ä¸çŸ¥é“æ€éº¼åš', x: 55, y: 65, cat: 'D' },
            { id: 'D10', label: 'å–˜æ¯ä½¿ç”¨', desc: 'ä¸äº†è§£å–˜æ¯æœå‹™æ€éº¼ç”¨', x: 25, y: 70, cat: 'D' },
            { id: 'D11', label: 'é€é¤æœå‹™', desc: 'é€é¤æœå‹™æ‰¾ä¸åˆ°æˆ–ä¸åˆèƒƒå£', x: 30, y: 25, cat: 'D' },
            { id: 'D12', label: 'äº¤é€šæ¥é€', desc: 'äº¤é€šæ¥é€è³‡æºä¸è¶³', x: 70, y: 80, cat: 'D' },
            { id: 'E01', label: 'ç§‘åˆ¥é¸æ“‡', desc: 'ä¸çŸ¥é“è©²çœ‹å“ªä¸€ç§‘', x: 15, y: 30, cat: 'E' },
            { id: 'E02', label: 'å°‹æ‰¾é†«é™¢', desc: 'æ‰¾ä¸åˆ°å¥½çš„é†«å¸«æˆ–é†«é™¢', x: 45, y: 60, cat: 'E' },
            { id: 'E03', label: 'å°±é†«å¾€è¿”', desc: 'é »ç¹å°±é†«å¾€è¿”å¤ªè¾›è‹¦', x: 65, y: 70, cat: 'E' },
            { id: 'E04', label: 'å‡ºé™¢éŠœæ¥', desc: 'å‡ºé™¢æº–å‚™ä¸çŸ¥é“å¦‚ä½•éŠœæ¥', x: 70, y: 95, cat: 'E' },
            { id: 'E05', label: 'ä½é™¢äººåŠ›', desc: 'ä½é™¢ç…§è­·äººåŠ›ä¸è¶³', x: 85, y: 92, cat: 'E' },
            { id: 'E06', label: 'é†«ç™‚è²»ç”¨', desc: 'é†«ç™‚è²»ç”¨è² æ“”éé‡', x: 80, y: 88, cat: 'E' },
            { id: 'E07', label: 'ç—…æƒ…äº†è§£', desc: 'ä¸äº†è§£ç—…æƒ…èˆ‡æ²»ç™‚é¸é …', x: 50, y: 75, cat: 'E' },
            { id: 'E08', label: 'è—¥ç‰©å‰¯ä½œ', desc: 'è—¥ç‰©å‰¯ä½œç”¨é›£ä»¥è™•ç†', x: 60, y: 65, cat: 'E' },
            { id: 'E09', label: 'æŠ—æ‹’å›è¨º', desc: 'é•·è¼©æŠ—æ‹’å›è¨ºæˆ–æª¢æŸ¥', x: 75, y: 70, cat: 'E' },
            { id: 'E10', label: 'é†«ç—…æºé€š', desc: 'é†«ç—…æºé€šå›°é›£', x: 65, y: 60, cat: 'E' },
            { id: 'F01', label: 'æ“”å¿ƒèµ°å¤±', desc: 'æ“”å¿ƒé•·è¼©èµ°å¤±', x: 60, y: 95, cat: 'F' },
            { id: 'F02', label: 'ç’°å¢ƒè·Œå€’', desc: 'å®¶ä¸­ç’°å¢ƒå®¹æ˜“è·Œå€’', x: 40, y: 92, cat: 'F' },
            { id: 'F03', label: 'ç“¦æ–¯å®‰å…¨', desc: 'é•·è¼©ç¨è‡ªæ“ä½œç“¦æ–¯ä¸å®‰å…¨', x: 50, y: 90, cat: 'F' },
            { id: 'F04', label: 'æµ´å®¤æ¿•æ»‘', desc: 'æµ´å®¤æ¿•æ»‘å±éšª', x: 30, y: 88, cat: 'F' },
            { id: 'F05', label: 'å¤œé–“éŠèµ°', desc: 'é•·è¼©åŠå¤œéŠèµ°æœ‰å±éšª', x: 70, y: 90, cat: 'F' },
            { id: 'F06', label: 'å‹•ç·šä¸é©', desc: 'å®¶ä¸­å‹•ç·šä¸é©åˆè¼ªæ¤…/åŠ©è¡Œå™¨', x: 55, y: 75, cat: 'F' },
            { id: 'F07', label: 'ç·Šæ€¥å‘¼å«', desc: 'æ²’æœ‰ç·Šæ€¥å‘¼å«ç³»çµ±', x: 20, y: 85, cat: 'F' },
            { id: 'F08', label: 'é–€æª»å‡ºå…¥', desc: 'é–€æª»å¤ªé«˜å‡ºå…¥ä¸ä¾¿', x: 35, y: 60, cat: 'F' },
            { id: 'G01', label: 'è²»ç”¨è² æ“”', desc: 'ç…§é¡§è²»ç”¨é¾å¤§ä¸çŸ¥å¦‚ä½•è² æ“”', x: 90, y: 98, cat: 'G' },
            { id: 'G02', label: 'è²¡ç”¢è©é¨™', desc: 'æ“”å¿ƒé•·è¼©è²¡ç”¢è¢«è©é¨™', x: 75, y: 85, cat: 'G' },
            { id: 'G03', label: 'è²¡ç”¢ä¿è­·', desc: 'ä¸çŸ¥é“å¦‚ä½•åšè²¡ç”¢ä¿è­·', x: 65, y: 70, cat: 'G' },
            { id: 'G04', label: 'ç›£è­·å®£å‘Š', desc: 'éœ€è¦ç”³è«‹ç›£è­·å®£å‘Šä½†ä¸çŸ¥å¦‚ä½•é€²è¡Œ', x: 70, y: 60, cat: 'G' },
            { id: 'G05', label: 'éºç”¢è¦åŠƒ', desc: 'éºç”¢è¦åŠƒä¸çŸ¥å¾ä½•é–‹å§‹', x: 65, y: 40, cat: 'G' },
            { id: 'G06', label: 'æ„å®šç›£è­·', desc: 'ä¸äº†è§£æ„å®šç›£è­·', x: 60, y: 35, cat: 'G' },
            { id: 'G07', label: 'å¸³æˆ¶ç®¡ç†', desc: 'é•·è¼©å¸³æˆ¶ç®¡ç†æ··äº‚', x: 50, y: 45, cat: 'G' },
            { id: 'G08', label: 'è²»ç”¨å ±ç¨…', desc: 'é†«ç™‚è²»ç”¨å ±ç¨…ä¸æ¸…æ¥š', x: 25, y: 25, cat: 'G' },
            { id: 'G09', label: 'ä¿éšªç†è³ ', desc: 'ä¿éšªç†è³ ç”³è«‹å›°é›£', x: 60, y: 55, cat: 'G' },
            { id: 'G10', label: 'è²¡ç”¢çˆ­è­°', desc: 'æ‰‹è¶³å°è²¡ç”¢åˆ†é…æœ‰çˆ­è­°', x: 95, y: 45, cat: 'G' },
            { id: 'H01', label: 'é¸æ“‡æ©Ÿæ§‹', desc: 'ä¸çŸ¥é“å¦‚ä½•é¸æ“‡é©åˆçš„æ©Ÿæ§‹', x: 50, y: 85, cat: 'H' },
            { id: 'H02', label: 'æ©Ÿæ§‹è²»ç”¨', desc: 'æ©Ÿæ§‹è²»ç”¨å¤ªé«˜', x: 85, y: 90, cat: 'H' },
            { id: 'H03', label: 'ç©ºåºŠå°‹æ‰¾', desc: 'æ‰¾ä¸åˆ°æœ‰ç©ºåºŠä½çš„æ©Ÿæ§‹', x: 80, y: 88, cat: 'H' },
            { id: 'H04', label: 'ç…§é¡§å“è³ª', desc: 'æ“”å¿ƒæ©Ÿæ§‹ç…§é¡§å“è³ª', x: 65, y: 92, cat: 'H' },
            { id: 'H05', label: 'æŠ—æ‹’å…¥ä½', desc: 'é•·è¼©æŠ—æ‹’å…¥ä½æ©Ÿæ§‹', x: 85, y: 80, cat: 'H' },
            { id: 'H06', label: 'å®¶äººåˆ†æ­§', desc: 'å®¶äººå°æ˜¯å¦é€æ©Ÿæ§‹æ„è¦‹åˆ†æ­§', x: 80, y: 48, cat: 'H' },
            { id: 'H07', label: 'åƒè§€è©¢å•', desc: 'åƒè§€æ©Ÿæ§‹ä¸çŸ¥é“è©²å•ä»€éº¼', x: 35, y: 35, cat: 'H' },
            { id: 'H08', label: 'è©•ä¼°æ©Ÿæ§‹', desc: 'ä¸çŸ¥é“å¦‚ä½•è©•ä¼°æ©Ÿæ§‹å¥½å£', x: 55, y: 70, cat: 'H' },
            { id: 'I01', label: 'å£“åŠ›å´©æ½°', desc: 'ç…§é¡§å£“åŠ›å¤§æƒ…ç·’å´©æ½°', x: 85, y: 98, cat: 'I' },
            { id: 'I02', label: 'æ²’æœ‰æ™‚é–“', desc: 'æ²’æœ‰è‡ªå·±çš„æ™‚é–“', x: 80, y: 85, cat: 'I' },
            { id: 'I03', label: 'å¥åº·å•é¡Œ', desc: 'èº«é«”å‡ºç¾å¥åº·å•é¡Œ', x: 75, y: 90, cat: 'I' },
            { id: 'I04', label: 'å­¤å–®ç„¡åŠ©', desc: 'è¦ºå¾—å­¤å–®ç„¡äººç†è§£', x: 65, y: 80, cat: 'I' },
            { id: 'I05', label: 'ç¡çœ å“è³ª', desc: 'ç¡çœ å“è³ªå¾ˆå·®', x: 70, y: 92, cat: 'I' },
            { id: 'I06', label: 'å·¥ä½œå¹³è¡¡', desc: 'å·¥ä½œèˆ‡ç…§é¡§é›£ä»¥å¹³è¡¡', x: 88, y: 90, cat: 'I' },
            { id: 'I07', label: 'ç´“å£“æ–¹å¼', desc: 'ä¸çŸ¥é“å¦‚ä½•ç´“å£“', x: 45, y: 40, cat: 'I' },
            { id: 'I08', label: 'æ„§ç–šè‡ªè²¬', desc: 'æ„Ÿåˆ°æ„§ç–šæˆ–è‡ªè²¬', x: 60, y: 65, cat: 'I' },
            { id: 'J01', label: 'é ç«‹é†«ç™‚', desc: 'ä¸äº†è§£é ç«‹é†«ç™‚æ±ºå®š', x: 50, y: 60, cat: 'J' },
            { id: 'J02', label: 'å–„çµ‚è¨è«–', desc: 'ä¸çŸ¥é“å¦‚ä½•å’Œå®¶äººè¨è«–å–„çµ‚è­°é¡Œ', x: 75, y: 70, cat: 'J' },
        ];

        const categories = {
            A: 'äººåŠ›è³‡æºå•é¡Œ',
            B: 'ç…§é¡§æŠ€å·§èˆ‡çŸ¥è­˜',
            C: 'æºé€šèˆ‡æƒ…ç·’å•é¡Œ',
            D: 'é•·ç…§è³‡æºèˆ‡ç”³è«‹',
            E: 'é†«ç™‚ç…§è­·å•é¡Œ',
            F: 'å±…å®¶å®‰å…¨å•é¡Œ',
            G: 'è²¡å‹™æ³•å¾‹å•é¡Œ',
            H: 'æ©Ÿæ§‹å®‰ç½®å•é¡Œ',
            I: 'ç…§é¡§è€…è‡ªæˆ‘ç…§é¡§',
            J: 'é ç«‹é†«ç™‚èˆ‡å–„çµ‚',
        };

        const QUADRANTS = {
            Q1: { title: 'å±æ©Ÿè™•ç†å€ (é«˜é‡è¦/é«˜é›£åº¦)', color: 'bg-red-100 border-red-300 text-red-800', dotColor: '#EF4444' },
            Q2: { title: 'å„ªå…ˆæ”¹å–„å€ (é«˜é‡è¦/ä½é›£åº¦)', color: 'bg-yellow-100 border-yellow-300 text-yellow-800', dotColor: '#F59E0B' },
            Q3: { title: 'æ—¥å¸¸ç¶­è­·å€ (ä½é‡è¦/ä½é›£åº¦)', color: 'bg-green-100 border-green-300 text-green-800', dotColor: '#10B981' },
            Q4: { title: 'é•·æœŸè¦åŠƒå€ (ä½é‡è¦/é«˜é›£åº¦)', color: 'bg-blue-100 border-blue-300 text-blue-800', dotColor: '#3B82F6' },
        };

        const getQuadrant = (x, y) => {
            if (x >= 50 && y >= 50) return 'Q1';
            if (x < 50 && y >= 50) return 'Q2';
            if (x < 50 && y < 50) return 'Q3';
            return 'Q4';
        };

        // --- ä¸»ç¨‹å¼å…ƒä»¶ ---
        function App() {
            const [currentStep, setCurrentStep] = useState('survey');
            const [questionsData, setQuestionsData] = useState(INITIAL_DATA);
            const [selectedIssues, setSelectedIssues] = useState(new Set());
            const [showAll, setShowAll] = useState(false);
            const [hoveredPoint, setHoveredPoint] = useState(null);
            const [adminSearch, setAdminSearch] = useState('');

            const [knowledgeBase, setKnowledgeBase] = useState(() => {
                const defaultLink = 'https://docs.google.com/presentation/d/12jtqOgifk8INhK26MNmwKupScSR3GqEgEErThAp4Wek/edit?usp=sharing';
                const initialKb = {};
                INITIAL_DATA.forEach(item => { initialKb[item.id] = defaultLink; });
                return initialKb;
            });

            const toggleIssue = (id) => {
                const newSet = new Set(selectedIssues);
                if (newSet.has(id)) newSet.delete(id);
                else newSet.add(id);
                setSelectedIssues(newSet);
            };

            const selectAllInCategory = (catKey) => {
                const newSet = new Set(selectedIssues);
                const catItems = questionsData.filter(i => i.cat === catKey);
                const allSelected = catItems.every(i => newSet.has(i.id));
                catItems.forEach(i => {
                    if (allSelected) newSet.delete(i.id);
                    else newSet.add(i.id);
                });
                setSelectedIssues(newSet);
            };

            const handleFinishSurvey = () => {
                if (selectedIssues.size === 0) { alert("è«‹è‡³å°‘é¸æ“‡ä¸€å€‹å•é¡Œ"); return; }
                setCurrentStep('analysis');
                setShowAll(false);
            };

            const handleUpdateQuestion = (id, field, value) => {
                setQuestionsData(prev => prev.map(item => {
                    if (item.id === id) {
                        if (field === 'x' || field === 'y') {
                            const numVal = parseInt(value, 10);
                            return { ...item, [field]: isNaN(numVal) ? 0 : Math.min(100, Math.max(0, numVal)) };
                        }
                        return { ...item, [field]: value };
                    }
                    return item;
                }));
            };

            const handleUpdateLink = (id, url) => {
                setKnowledgeBase(prev => ({ ...prev, [id]: url }));
            };

            // --- ä»‹é¢æ¸²æŸ“ï¼šå¾Œå°ç®¡ç† ---
            if (currentStep === 'admin') {
                const filteredData = questionsData.filter(item => 
                    item.label.includes(adminSearch) || item.desc.includes(adminSearch) || item.id.includes(adminSearch)
                );

                return (
                    <div className="max-w-7xl mx-auto p-4 min-h-screen">
                        <header className="bg-white p-6 rounded-xl shadow-sm mb-6 flex justify-between items-center border-l-8 border-indigo-600">
                            <div>
                                <h1 className="text-2xl font-bold text-gray-800 flex items-center gap-2">
                                    <Icon name="Settings" className="text-indigo-600" /> åº§æ¨™èˆ‡çŸ¥è­˜åº«ç®¡ç†
                                </h1>
                            </div>
                            <button onClick={() => setCurrentStep('analysis')} className="flex items-center gap-2 px-4 py-2 border rounded-lg bg-gray-50 hover:bg-white">
                                <Icon name="RotateCcw" size={16} /> è¿”å›åˆ†æ
                            </button>
                        </header>
                        <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                            <div className="p-4 border-b bg-gray-50 flex items-center gap-4">
                                <div className="relative flex-1">
                                    <Icon name="Search" className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={18} />
                                    <input type="text" placeholder="æœå°‹..." className="w-full pl-10 pr-4 py-2 border rounded-lg" value={adminSearch} onChange={(e) => setAdminSearch(e.target.value)} />
                                </div>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="w-full text-left">
                                    <thead>
                                        <tr className="bg-gray-100 text-sm font-bold border-b">
                                            <th className="p-4 w-20">ç·¨è™Ÿ</th>
                                            <th className="p-4 w-64">åç¨±èˆ‡å‚™è¨»</th>
                                            <th className="p-4 w-40">åº§æ¨™ (X/Y)</th>
                                            <th className="p-4">çŸ¥è­˜é€£çµ</th>
                                        </tr>
                                    </thead>
                                    <tbody className="text-sm">
                                        {filteredData.map(item => (
                                            <tr key={item.id} className="border-b hover:bg-gray-50 transition-colors">
                                                <td className="p-4 font-mono text-gray-500">{item.id}</td>
                                                <td className="p-4">
                                                    <input type="text" className="font-bold border rounded px-2 py-1 w-full mb-1" value={item.label} onChange={(e) => handleUpdateQuestion(item.id, 'label', e.target.value)} />
                                                    <textarea className="text-xs border rounded px-2 py-1 w-full h-12" value={item.desc} onChange={(e) => handleUpdateQuestion(item.id, 'desc', e.target.value)} />
                                                </td>
                                                <td className="p-4">
                                                    <div className="flex flex-col gap-1">
                                                        <div className="flex items-center justify-between text-xs"><span>X(é›£)</span><input type="number" className="w-12 border rounded text-center" value={item.x} onChange={(e) => handleUpdateQuestion(item.id, 'x', e.target.value)} /></div>
                                                        <div className="flex items-center justify-between text-xs"><span>Y(é‡)</span><input type="number" className="w-12 border rounded text-center" value={item.y} onChange={(e) => handleUpdateQuestion(item.id, 'y', e.target.value)} /></div>
                                                    </div>
                                                </td>
                                                <td className="p-4">
                                                    <input type="text" className="w-full border rounded px-2 py-1 text-xs" value={knowledgeBase[item.id] || ''} onChange={(e) => handleUpdateLink(item.id, e.target.value)} />
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            }

            // --- ä»‹é¢æ¸²æŸ“ï¼šå ±å‘ŠåŒ¯å‡º ---
            if (currentStep === 'report') {
                const date = new Date().toLocaleDateString('zh-TW');
                const q1Issues = questionsData.filter(i => selectedIssues.has(i.id) && getQuadrant(i.x, i.y) === 'Q1');
                const q2Issues = questionsData.filter(i => selectedIssues.has(i.id) && getQuadrant(i.x, i.y) === 'Q2');
                return (
                    <div className="max-w-4xl mx-auto min-h-screen bg-gray-50 p-4 print:p-0 print:bg-white">
                        <div className="no-print mb-6 flex justify-between items-center bg-gray-800 text-white p-4 rounded-lg">
                            <button onClick={() => setCurrentStep('analysis')} className="flex items-center gap-2"><Icon name="ChevronLeft" /> è¿”å›åˆ†æ</button>
                            <button onClick={() => window.print()} className="bg-indigo-600 px-6 py-2 rounded-full font-bold flex items-center gap-2"><Icon name="Printer" /> åˆ—å° / PDF</button>
                        </div>
                        <div className="bg-white p-8 border print:border-none shadow-xl mx-auto w-full max-w-[210mm] min-h-[297mm]">
                            <header className="border-b-2 border-indigo-600 pb-4 mb-6 flex justify-between items-end">
                                <div><h1 className="text-3xl font-bold">é•·ç…§å›°å¢ƒåˆ†æå ±å‘Š</h1><p className="text-gray-500">è‡ªæˆ‘æª¢æ¸¬èˆ‡è¡Œå‹•è¨ˆç•«</p></div>
                                <div className="text-right"><div className="text-sm text-gray-500">æ—¥æœŸ</div><div className="font-bold text-lg">{date}</div></div>
                            </header>
                            <div className="grid grid-cols-2 gap-8 mb-8">
                                <div className="border rounded-lg aspect-square relative">
                                    <svg viewBox="0 0 110 110" className="w-full h-full">
                                        <line x1="5" y1="55" x2="105" y2="55" stroke="#ccc" strokeWidth="0.5" />
                                        <line x1="55" y1="105" x2="55" y2="5" stroke="#ccc" strokeWidth="0.5" />
                                        {questionsData.filter(i => selectedIssues.has(i.id)).map(item => (
                                            <circle key={item.id} cx={item.x} cy={100 - item.y + 5} r="2" fill={QUADRANTS[getQuadrant(item.x, item.y)].dotColor} />
                                        ))}
                                    </svg>
                                </div>
                                <div>
                                    <h3 className="font-bold border-b-2 border-red-200 mb-2">ğŸ”¥ é«˜å„ªå…ˆè™•ç†æ¸…å–®</h3>
                                    <ul className="text-sm space-y-1">
                                        {q1Issues.concat(q2Issues).slice(0, 10).map(i => <li key={i.id}>â€¢ {i.label}</li>)}
                                    </ul>
                                </div>
                            </div>
                            <h3 className="font-bold text-lg mb-4 flex items-center gap-2"><Icon name="Edit3" /> ç…§é¡§è¨ˆç•«ç­†è¨˜å€</h3>
                            <div className="grid grid-cols-2 gap-4">
                                {['ğŸ¥ é†«ç™‚èˆ‡è­·ç†', 'ğŸ  ç”Ÿæ´»èˆ‡å®‰å…¨', 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶åº­èˆ‡æºé€š', 'â˜• è‡ªæˆ‘èª¿é©'].map(title => (
                                    <div key={title} className="border p-3 min-h-[180px] rounded-lg">
                                        <div className="font-bold border-b mb-2">{title}</div>
                                        <div className="ruled-paper h-32"></div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            // --- ä»‹é¢æ¸²æŸ“ï¼šå•å·èª¿æŸ¥ ---
            if (currentStep === 'survey') {
                return (
                    <div className="max-w-4xl mx-auto p-4">
                        <header className="mb-8 text-center bg-white p-8 rounded-2xl shadow-sm relative">
                            <button onClick={() => setCurrentStep('admin')} className="absolute top-4 right-4 text-gray-400 hover:text-indigo-600 flex items-center gap-1 text-xs">
                                <Icon name="Settings" size={14} /> å¾Œå°ç®¡ç†
                            </button>
                            <h1 className="text-4xl font-black text-gray-800 mb-2">é•·ç…§å›°å¢ƒè¨ºæ–·é›·é”</h1>
                            <p className="text-gray-500">å‹¾é¸æ‚¨æ­£é¢è‡¨çš„æŒ‘æˆ°ï¼Œç²å¾—è¦–è¦ºåŒ–åˆ†æèˆ‡è§£æ–¹ç°¡å ±</p>
                        </header>
                        <div className="space-y-6">
                            {Object.entries(categories).map(([key, name]) => (
                                <div key={key} className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                                    <div className="bg-blue-50 px-5 py-3 border-b border-blue-100 flex justify-between items-center">
                                        <h3 className="font-bold text-blue-900">{key}. {name}</h3>
                                        <button onClick={() => selectAllInCategory(key)} className="text-xs text-blue-600 underline">å…¨é¸/å–æ¶ˆ</button>
                                    </div>
                                    <div className="p-5 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                        {questionsData.filter(i => i.cat === key).map(i => (
                                            <label key={i.id} className={`flex items-start p-3 rounded-lg border transition-all cursor-pointer ${selectedIssues.has(i.id) ? 'bg-blue-50 border-blue-300 ring-1 ring-blue-300' : 'bg-white hover:bg-gray-50 border-gray-100'}`}>
                                                <input type="checkbox" className="mt-1 mr-3 h-5 w-5 rounded text-blue-600" checked={selectedIssues.has(i.id)} onChange={() => toggleIssue(i.id)} />
                                                <div><div className="font-bold text-gray-900 leading-tight">{i.label}</div><div className="text-[10px] text-gray-400 mt-1">{i.desc}</div></div>
                                            </label>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>
                        <div className="sticky bottom-4 bg-white/90 backdrop-blur-sm border-t p-6 mt-8 flex justify-between items-center shadow-2xl rounded-2xl">
                            <div className="text-gray-700">å·²é¸æ“‡ <span className="text-3xl font-black text-blue-600">{selectedIssues.size}</span> é …å•é¡Œ</div>
                            <button onClick={handleFinishSurvey} className="bg-blue-600 text-white px-10 py-4 rounded-full font-black text-lg flex items-center gap-2 shadow-lg hover:bg-blue-700 transition-all transform hover:scale-105">é–‹å§‹åˆ†æ <Icon name="ArrowRight" /></button>
                        </div>
                    </div>
                );
            }

            // --- ä»‹é¢æ¸²æŸ“ï¼šåˆ†æä¸»ç•«é¢ ---
            return (
                <div className="max-w-7xl mx-auto p-4">
                    <div className="flex justify-between items-center mb-6 bg-white p-5 rounded-2xl shadow-sm">
                        <h2 className="text-2xl font-black text-gray-800">åˆ†æè¨ºæ–·çµæœ</h2>
                        <div className="flex gap-2">
                            <button onClick={() => setCurrentStep('report')} className="flex items-center gap-2 px-4 py-2 bg-indigo-50 text-indigo-600 border border-indigo-200 rounded-xl font-bold hover:bg-indigo-100"><Icon name="FileOutput" size={18} /> åŒ¯å‡ºå ±å‘Š</button>
                            <button onClick={() => setCurrentStep('admin')} className="flex items-center gap-2 px-4 py-2 border rounded-xl hover:bg-gray-100"><Icon name="Settings" size={18} /> ç®¡ç†å¾Œå°</button>
                            <button onClick={() => setCurrentStep('survey')} className="flex items-center gap-2 px-4 py-2 border rounded-xl hover:bg-gray-100"><Icon name="RotateCcw" size={18} /> é‡é¸å•é¡Œ</button>
                        </div>
                    </div>
                    <div className="grid lg:grid-cols-3 gap-6">
                        <div className="lg:col-span-2 space-y-4">
                            <div className="bg-white p-4 rounded-2xl border flex justify-between items-center">
                                <div className="flex items-center gap-2 font-bold"><Icon name="Filter" className="text-blue-600" /> é¡¯ç¤ºè¨­å®šï¼š</div>
                                <div className="bg-gray-100 p-1 rounded-xl flex gap-1">
                                    <button onClick={() => setShowAll(false)} className={`px-4 py-2 rounded-lg text-sm font-bold transition-all ${!showAll ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-500'}`}>æˆ‘çš„å•é¡Œ ({selectedIssues.size})</button>
                                    <button onClick={() => setShowAll(true)} className={`px-4 py-2 rounded-lg text-sm font-bold transition-all ${showAll ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-500'}`}>å…¨éƒ¨ 100 é¡Œ</button>
                                </div>
                            </div>
                            <div className="bg-white p-8 rounded-3xl shadow-xl border relative aspect-square">
                                <div className="absolute inset-4 pointer-events-none grid grid-cols-2 grid-rows-2">
                                    <div className="border-r border-b p-2"><span className="text-xs font-black text-yellow-600 bg-yellow-100 px-2 py-1 rounded">II. å„ªå…ˆæ”¹å–„</span></div>
                                    <div className="border-b p-2 text-right"><span className="text-xs font-black text-red-600 bg-red-100 px-2 py-1 rounded">I. å±æ©Ÿè™•ç†</span></div>
                                    <div className="border-r p-2 flex items-end"><span className="text-xs font-black text-green-600 bg-green-100 px-2 py-1 rounded">III. æ—¥å¸¸ç¶­è­·</span></div>
                                    <div className="p-2 flex items-end justify-end"><span className="text-xs font-black text-blue-600 bg-blue-100 px-2 py-1 rounded">IV. é•·æœŸè¦åŠƒ</span></div>
                                </div>
                                <svg viewBox="0 0 110 110" className="w-full h-full relative z-10">
                                    <line x1="5" y1="55" x2="105" y2="55" stroke="#e2e8f0" strokeWidth="0.5" />
                                    <line x1="55" y1="105" x2="55" y2="5" stroke="#e2e8f0" strokeWidth="0.5" />
                                    {questionsData.map(i => {
                                        const isSelected = selectedIssues.has(i.id);
                                        if (!isSelected && !showAll) return null;
                                        const color = isSelected ? QUADRANTS[getQuadrant(i.x, i.y)].dotColor : '#cbd5e1';
                                        return (
                                            <g key={i.id} onMouseEnter={() => setHoveredPoint(i.id)} onMouseLeave={() => setHoveredPoint(null)} className="cursor-pointer">
                                                <circle cx={i.x} cy={100 - i.y + 5} r={isSelected ? 1.8 : 1} fill={color} opacity={isSelected ? 1 : 0.3} stroke="white" strokeWidth="0.2" />
                                                {isSelected && <text x={i.x} y={100 - i.y + 3} fontSize="2.5" fill={color} fontWeight="bold" textAnchor="middle">{i.label}</text>}
                                            </g>
                                        );
                                    })}
                                </svg>
                                {hoveredPoint && (
                                    <div className="absolute top-4 left-4 bg-gray-900 text-white p-4 rounded-xl shadow-2xl z-50 max-w-xs animate-in fade-in duration-200">
                                        {(() => {
                                            const i = questionsData.find(q => q.id === hoveredPoint);
                                            return <>
                                                <div className="font-black text-yellow-400 text-lg mb-1">{i.label}</div>
                                                <p className="text-xs text-gray-300 leading-relaxed">{i.desc}</p>
                                                <div className="mt-2 pt-2 border-t border-gray-700 text-[10px] text-gray-500">é›£åº¦: {i.x} | é‡è¦æ€§: {i.y}</div>
                                            </>;
                                        })()}
                                    </div>
                                )}
                            </div>
                        </div>
                        <div className="space-y-4">
                            <div className="bg-blue-600 text-white p-6 rounded-3xl shadow-lg">
                                <h3 className="font-black text-xl mb-2 flex items-center gap-2"><Icon name="Info" /> åˆ†æç¸½çµ</h3>
                                <p className="text-sm opacity-90 leading-relaxed">æˆ‘å€‘åµæ¸¬åˆ°æ‚¨æœ‰ {selectedIssues.size} å€‹é—œéµæŒ‘æˆ°ã€‚å»ºè­°å„ªå…ˆè™•ç†ä½æ–¼ <span className="font-black underline">ç´…è‰²å€åŸŸ</span> çš„æ ¸å¿ƒç—›é»ã€‚</p>
                            </div>
                            {['Q1', 'Q2', 'Q3', 'Q4'].map(quad => {
                                const issues = questionsData.filter(i => selectedIssues.has(i.id) && getQuadrant(i.x, i.y) === quad);
                                if (issues.length === 0) return null;
                                return (
                                    <div key={quad} className={`rounded-3xl border overflow-hidden shadow-sm ${QUADRANTS[quad].color}`}>
                                        <div className="p-4 font-black text-sm flex justify-between items-center border-b border-black/5">
                                            {QUADRANTS[quad].title} <span className="bg-white/50 px-3 py-1 rounded-full text-xs">{issues.length}</span>
                                        </div>
                                        <div className="p-4 bg-white/50 space-y-3">
                                            {issues.map(i => (
                                                <div key={i.id} className="flex flex-col gap-2 pb-3 border-b border-black/5 last:border-0">
                                                    <div className="flex items-start gap-2">
                                                        <Icon name="CheckCircle" className="mt-1 flex-shrink-0 text-gray-400" size={14} />
                                                        <div><div className="font-bold text-gray-800">{i.label}</div><div className="text-[10px] text-gray-500">{i.desc}</div></div>
                                                    </div>
                                                    {knowledgeBase[i.id] && (
                                                        <a href={knowledgeBase[i.id]} target="_blank" className="ml-6 flex items-center gap-2 text-[11px] bg-indigo-600 text-white px-3 py-1.5 rounded-full w-fit hover:bg-indigo-700">
                                                            <Icon name="FileText" size={12} /> é–±è®€çŸ¥è­˜ç°¡å ±
                                                        </a>
                                                    )}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
